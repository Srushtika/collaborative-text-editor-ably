(function(){"use strict";var t={514:function(t,e,n){var o=n(144),a=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("Container")],1)},r=[],l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"grid grid-cols-5 h-screen"},[e("TextEditor",{staticClass:"col-span-3"}),e("CodeSnippet",{staticClass:"col-span-2"})],1)},s=[],i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"bg-white text-left p-2.5 font-ui-sans-serif mx-11"},[e("AvatarStack"),t._l(t.getTextEditorContentBlocks,(function(t){return e("TextBlock",{key:t.id,attrs:{contentBlock:t}})}))],2)},c=[],d=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-5 font-sans"},[e("div",{staticClass:"flex -space-x-2 justify-end"},t._l(t.collabMembersArr,(function(n){return e("div",{key:n.clientId,staticClass:"relative inline-flex items-center justify-center w-10 h-10 ring-2 ring-white rounded-full",class:n.isConnected?t.bgColours[n.profileData.avatarColour]:"bg-gray-500"},[e("span",{staticClass:"font-medium text-white dark:text-white"},[t._v(t._s(n.profileData.initials))]),n.isConnected?e("span",{staticClass:"bottom-0 right-7 absolute w-2 h-2 bg-green-600 ring-2 ring-white dark:border-gray-800 rounded-full"}):t._e()])})),0)])},u=[],b=n(629),p={name:"AvatarStack",data(){return{collabMembersArr:[],bgColours:{red:"bg-red-400",orange:"bg-orange-400",green:"bg-green-400",amber:"bg-amber-400",lime:"bg-lime-400",cyan:"bg-cyan-400",blue:"bg-blue-400",indigo:"bg-indigo-400"}}},computed:{...(0,b.Se)(["getCollabMembers"])},watch:{getCollabMembers:function(t){this.collabMembersArr=t}}},m=p,g=n(1),h=(0,g.Z)(m,d,u,!1,null,null,null),y=h.exports,x=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"relative"},["div"==t.contentBlock.type?e("div",{staticClass:"p-2 hover:bg-gray-100 border border-transparent",class:t.contentBlock.styling,staticStyle:{outline:"0px solid transparent"},attrs:{id:t.contentBlock.id,contenteditable:""},on:{keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()},focus:function(e){return t.setBlockLocation(e)},input:t.onInput}},[t._v(" "+t._s(t.contentBlock.content)+" "),t._l(t.contentBlock.listItems,(function(n){return t.contentBlock.listItems?e("ul",{staticClass:"list-disc pl-5"},[e("li",[t._v(t._s(n))])]):t._e()}))],2):t._e(),"hr"==t.contentBlock.type?e("hr",{staticClass:"h-px my-8 bg-gray-300 border-1 dark:bg-gray-300"}):t._e(),"checkbox"==t.contentBlock.type?e("div",{staticClass:"hover:bg-gray-100 flex items-center border border-transparent",class:t.contentBlock.styling,staticStyle:{outline:"0px solid transparent"},attrs:{id:t.contentBlock.id,contenteditable:""},on:{keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()},focus:function(e){return t.setBlockLocation(e)},input:t.onInput}},[e("input",{staticClass:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600",staticStyle:{outline:"0px solid transparent"},attrs:{id:t.contentBlock.id+"box",type:"checkbox",value:""},domProps:{checked:t.contentBlock.isChecked},on:{click:t.onChecked}}),e("label",{staticClass:"ml-2 checkbox-1",attrs:{for:t.contentBlock.id+"box"}},[t._v(t._s(t.contentBlock.content))])]):t._e()])])},C=[],f=n(334),k={name:"TextBlock",props:["contentBlock"],data(){return{locationUpdate:null,borderColours:{red:"border-red-400",orange:"border-orange-400",green:"border-green-400",amber:"border-amber-400",lime:"border-lime-400",cyan:"border-cyan-400",blue:"border-blue-400",indigo:"border-indigo-400"},showLabel:!1}},computed:{...(0,b.Se)(["getLocationUpdate"])},watch:{getLocationUpdate:function(t){if(t.currentLocation){const e=document.getElementById(t.currentLocation.blockId),n=document.getElementById(t.previousLocation.blockId),o=t.member.profileData.avatarColour,a=this.borderColours[o];t.currentLocation.blockId!=t.previousLocation.blockId?(e&&e.classList.replace("border-transparent",a),n&&n.classList.replace(a,"border-transparent")):e.classList.replace("border-transparent",a),this.showLabel=!0}}},methods:{...(0,b.nv)(["setBlockLocation","updateTextContentGlobally"]),onInput(t){const e=new f(document.getElementById(this.contentBlock.id)),n=e.getPos(),o=t.srcElement.childNodes[t.srcElement.childNodes.length-1];if(o&&"UL"==o.nodeName){const e=document.getElementById(t.target.id).getElementsByTagName("li"),o=[...e].map((t=>t.innerText));this.updateTextContentGlobally({blockId:t.target.id,text:o,type:"list",caretPos:n})}else this.updateTextContentGlobally({blockId:t.target.id,text:t.target.innerText,type:"div",caretPos:n})},onChecked(){const t=document.getElementById(this.contentBlock.id+"box");this.updateTextContentGlobally({blockId:this.contentBlock.id,type:"checkbox",isChecked:t.checked})}},components:{},created(){console.log("COMPONENT CREATED")},updated(){const t=new f(document.getElementById(this.contentBlock.id));t.setPos(this.contentBlock.caretPos)}},v=k,w=(0,g.Z)(v,x,C,!1,null,null,null),_=w.exports,B={name:"TextEditor",data(){return{locationUpdate:null,borderColours:{red:"border-red-400",orange:"border-orange-400",green:"border-green-400",amber:"border-amber-400",lime:"border-lime-400",cyan:"border-cyan-400",blue:"border-blue-400",indigo:"border-indigo-400"}}},computed:{...(0,b.Se)(["getTextEditorContentBlocks"])},methods:{...(0,b.nv)(["setBlockLocation"])},components:{AvatarStack:y,TextBlock:_},updated(){console.log("PARENT UPDATED")}},T=B,S=(0,g.Z)(T,i,c,!1,null,null,null),E=S.exports,U=function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-left bg-gray-800 flex flex-col"},[e("Header",{staticClass:"mx-auto"}),e("VueCodeHighlight",{staticClass:"code-sample",attrs:{language:"javascript"}},[t._v(" "+t._s(t.codeSnippet)+" ")])],1)},P=[],I=n(896),A=function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-white font-medium"},[e("div",{staticClass:"mx-2 p-6 bg-white rounded-lg shadow dark:bg-gray-800"},[t._m(0),e("p",{staticClass:"mb-3 font-normal text-gray-500 dark:text-gray-400"},[t._v("Open this app in a new tab or share it with friends.")]),e("a",{staticClass:"inline-flex items-center text-blue-600 hover:underline",attrs:{href:"https://github.com/ably-labs/collaborative-text-editor-ably",target:"_blank"}},[t._v(" See it on GitHub "),e("svg",{staticClass:"w-5 h-5 ml-2",attrs:{fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{d:"M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"}}),e("path",{attrs:{d:"M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"}})])])]),t._m(1)])},L=[function(){var t=this,e=t._self._c;return e("a",{attrs:{href:"#"}},[e("h5",{staticClass:"mb-2 text-2xl font-semibold tracking-tight text-gray-900 dark:text-white"},[t._v("How to try this demo")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"mx-2 p-6 bg-white rounded-lg shadow dark:bg-gray-800"},[e("a",{attrs:{href:"#"}},[e("h5",{staticClass:"mb-2 text-2xl font-semibold tracking-tight text-gray-900 dark:text-white"},[t._v("Powered by Ably Spaces SDK")])]),e("p",{staticClass:"mb-3 font-normal text-gray-500 dark:text-gray-400"},[t._v(" The Spaces SDK helps you build collaborative environments for your application to enable synchrnous collaboration between members. ")])])}],M={name:"Header"},O=M,Z=(0,g.Z)(O,A,L,!1,null,null,null),D=Z.exports,j={name:"CodeSnippet",data(){return{codeSnippet:null}},components:{VueCodeHighlight:I.w,Header:D},created(){this.codeSnippet="\n    // Create a new space\n    const space = await spaces.get('demoSlideshow');\n\n    // Enter a space, publishing an event for other members\n    space.enter({\n      username: 'Claire Lemons',\n      avatar: 'https://slides-internal.com/users/clemons.png',\n    });\n\n    // Subscribe to all member events in a space\n    space.members.subscribe((memberUpdate) => {\n      console.log(memberUpdate);\n    });\n\n    // Publish your location based on the UI element selected\n    space.locations.set({ blockId: '2'});\n\n    // Subscribe to location events from all members in a space\n    space.locations.subscribe('update', (locationUpdate) => {\n      console.log(locationUpdate);\n    });\n\n    // Subscribe to events published on \"mousemove\" by all members\n    space.cursors.subscribe('update', (cursorUpdate) => {\n      console.log(cursorUpdate);\n    });\n\n    // Publish a your cursor position on \"mousemove\" including optional data\n    window.addEventListener('mousemove', ({ clientX, clientY }) => {\n      space.cursors.set({ position: { x: clientX, y: clientY }, data: { color: 'red' } });\n    });\n   "}},H=j,G=(0,g.Z)(H,U,P,!1,null,null,null),N=G.exports,R={name:"Container",data(){return{}},components:{TextEditor:E,CodeSnippet:N}},V=R,K=(0,g.Z)(V,l,s,!1,null,null,null),z=K.exports,X={name:"App",data(){return{msg:null}},created(){this.btnText="Creating your watch party...",this.isCreatingRoom=!0,this.isAdmin=!0,this.instantiateAbly({username:"Srush",isAdmin:!0})},components:{Container:z},methods:{...(0,b.nv)(["instantiateAbly"])}},Y=X,F=(0,g.Z)(Y,a,r,!1,null,null,null),W=F.exports,$=n(182),q=n(69);o.ZP.use(b.ZP);var J=new b.ZP.Store({state:{ablyClient:null,spaceClient:null,myClientId:null,collabSpace:null,allAvatarColours:["red","orange","green","amber","lime","cyan","blue","indigo"],collabMembers:[],locationUpdate:{},textUpdatesChannel:null,textUpdate:null,textEditorContentBlocks:[{id:"header-h1",type:"div",styling:"text-4xl font-black",content:"ðŸ‘©ðŸ»â€ðŸ’» Collaborative block text editor",caretPos:null},{id:"hr-1",type:"hr",styling:"h-px my-8 bg-gray-300 border-1 dark:bg-gray-300",caretPos:null},{id:"body-1",type:"div",styling:"text-lg",content:"ðŸ‘‹ Welcome! This is a demo text editor powered by Ably's Spaces SDK. Open another instance of this in a new tab and explore the multiplayer collaboration features.",caretPos:null},{id:"body-2",type:"div",styling:"text-lg",content:"Available features:",caretPos:null},{id:"body-3",type:"div",styling:"text-lg",content:"",listItems:["Avatar Stack","User in-app location","Live cursors","Component locking","Live app updates"],caretPos:null},{id:"hr-2",type:"hr",styling:"h-px my-8 bg-gray-300 border-1 dark:bg-gray-300",caretPos:null},{id:"header-h2-2",type:"div",styling:"text-lg pl-2",content:"TODOs",caretPos:null},{id:"chk-1",type:"checkbox",styling:"text-lg pl-2",content:"Tried the demo",isChecked:!0,caretPos:null},{id:"chk-2",type:"checkbox",styling:"text-lg pl-2",content:"Checked out the GitHub repo",isChecked:!1,caretPos:null},{id:"chk-3",type:"checkbox",styling:"text-lg pl-2",content:"Signed up to Ably",isChecked:!0,caretPos:null}]},getters:{getAblyClient:t=>t.ablyClient,getSpaceClient:t=>t.spaceClient,getMyClientId:t=>t.myClientId,getCollabSpace:t=>t.collabSpace,getCollabMembers:t=>t.collabMembers,getLocationUpdate:t=>t.locationUpdate,getTextEditorContentBlocks:t=>t.textEditorContentBlocks,getTextUpdatesChannel:t=>t.textUpdatesChannel,getTextUpdate:t=>t.textUpdate},mutations:{setAblyClient(t,e){t.ablyClient=e},setSpaceClient(t,e){t.spaceClient=e},setCollabSpace(t,e){t.collabSpace=e},setMyClientId(t,e){t.myClientId=e},setCollabMembers(t,e){t.collabMembers=e},setLocationUpdate(t,e){t.locationUpdate=e},updateTextEditorContentBlocks(t,e){const n=e.data.type;e.data.text;console.log("UPDATE CARET POS",e.data.caretPos),t.textEditorContentBlocks.forEach(((o,a,r)=>{r[a].id==e.data.blockId&&("div"==n?t.textEditorContentBlocks[a].content=e.data.text:"list"==n?t.textEditorContentBlocks[a].listItems=e.data.text:"checkbox"==n&&(t.textEditorContentBlocks[a].isChecked=e.data.isChecked)),t.textEditorContentBlocks[a].caretPos=e.data.caretPos}))},setTextUpdatesChannel(t,e){t.textUpdatesChannel=e},setTextUpdate(t,e){t.textUpdate=e}},actions:{async instantiateAbly(t){const e=new $.Realtime({authUrl:"/auth-ably"}),n=new q.Z(e),o=await n.get("text-editor");t.commit("setAblyClient",e),t.commit("setSpaceClient",n),t.commit("setCollabSpace",o),t.commit("setMyClientId",e.auth.clientId),t.state.collabSpace.enter({username:t.state.myClientId,initials:t.state.myClientId.slice(-2).toUpperCase(),avatarColour:t.state.allAvatarColours[Math.floor(Math.random()*t.state.allAvatarColours.length)]}),t.dispatch("subscribeToMembers"),t.dispatch("subscribeToTextUpdateChannel"),t.dispatch("subscribeToLocations")},subscribeToMembers(t){t.state.collabSpace.on("membersUpdate",(e=>{t.commit("setCollabMembers",e),console.log("Total user count",t.state.collabMembers.length,"Members:",t.state.collabMembers[0].location)}))},subscribeToTextUpdateChannel(t){const e=t.state.ablyClient.channels.get("text-updates");t.commit("setTextUpdatesChannel",e),e.subscribe((e=>{t.commit("updateTextEditorContentBlocks",e)}))},subscribeToLocations(t){t.state.collabSpace.locations.on("locationUpdate",(e=>{t.commit("setLocationUpdate",e)}))},setBlockLocation(t,e){t.state.collabSpace.locations.set({blockId:e.target.id})},updateTextContentGlobally(t,e){t.state.textUpdatesChannel.publish("newText",e)}}});o.ZP.use(I.Z),o.ZP.config.productionTip=!1,new o.ZP({store:J,render:t=>t(W)}).$mount("#app")}},e={};function n(o){var a=e[o];if(void 0!==a)return a.exports;var r=e[o]={id:o,loaded:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}n.m=t,function(){var t=[];n.O=function(e,o,a,r){if(!o){var l=1/0;for(d=0;d<t.length;d++){o=t[d][0],a=t[d][1],r=t[d][2];for(var s=!0,i=0;i<o.length;i++)(!1&r||l>=r)&&Object.keys(n.O).every((function(t){return n.O[t](o[i])}))?o.splice(i--,1):(s=!1,r<l&&(l=r));if(s){t.splice(d--,1);var c=a();void 0!==c&&(e=c)}}return e}r=r||0;for(var d=t.length;d>0&&t[d-1][2]>r;d--)t[d]=t[d-1];t[d]=[o,a,r]}}(),function(){n.d=function(t,e){for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.hmd=function(t){return t=Object.create(t),t.children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t}}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,o){var a,r,l=o[0],s=o[1],i=o[2],c=0;if(l.some((function(e){return 0!==t[e]}))){for(a in s)n.o(s,a)&&(n.m[a]=s[a]);if(i)var d=i(n)}for(e&&e(o);c<l.length;c++)r=l[c],n.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return n.O(d)},o=self["webpackChunkapp_collaborative_text_editor_vue"]=self["webpackChunkapp_collaborative_text_editor_vue"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(514)}));o=n.O(o)})();
//# sourceMappingURL=app.07d3a4b1.js.map